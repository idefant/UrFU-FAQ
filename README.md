
#  UrFU - FAQ

## О проекте вкратце

**Название проекта:** Автоматизация общения с абитуриентами

__Команда:__ Improve Yourself

__Формат системы:__  Web-сервис, телеграмм-бот

__Цель:__ Создание сервиса для автоматизации общения с абитуриентами УрФУ

__Описание проекта:__ Один или несколько форматов автоматизации ответов на частые вопросы по приему в УрФУ. Это может быть чат-бот, лендинг с удобным поиском по вопросам или любой другой подходящий сервис.

__Целевая аудитория:__ Абитуриенты УрФУ

__Основное преимущество:__  На данный момент не существует достаточно удобных аналогов решения поставленной проблемы конкретно в УРФУ, однако существует несколько сайтов, позволяющие создать своего чат-бота или FAQ-страницы для необходимых задач.
- __Недостатки:__ высокая стоимость пользования и обслуживания бота, отсутствует гибкость решения, полная зависимость от работы чужого сервиса
- __Примеры:__
     - [«Botmother»](https://botmother.com/ru)
     - [«FAQ Bot»](https://www.faqbot.ai/)

__Работа пользователя с системой:__ Пользователь заходит на сайт. Выбрав категории, легко находит необходимую информацию



##  Стек технологий: 

-	__Язык программирования и фреймворк__ - В проекте используется фреймворк Python'а - Flask.
-	__Веб-сайт__ - Для создания сайта используются стандартные средства для web-разработки (HTML, CSS, JS)
-   __База данных__ - Для хранения контента и технической информации - Использование одной из популярных БД
-	__Чат-бот__ - Использование API VK для работы с ВКонтакте
-	__Поисковая система__ - Использование такого набора библиотек для обработки пользовательских запросов (возможно работа с дополнительными):
    -	enchant - Проверка орфографии и исправление слов
    -	fuzzywuzzy - Многофункциональная библиотека для нечеткого сравнения строк
    -	 pymorphy2 - Приведение слов к начальной форме
-	__Админ-панель__ - Обладает функционалом для работы c категориями
    -	контентом в виде пары: вопрос-ответ в визуальном редакторе
    -	системой контроля доступа в отдельные части админки
    -	технической информацией для отладки работы поисковой системы
    -	системой сортировки вопросов для настройки популярности



## Основные требования к ПО для пользования:

- Python 3.x

- Также пакеты для работы приложения (этот список есть в requirements.txt):

  ```
  alembic==1.6.0
  certifi==2020.12.5
  chardet==4.0.0
  click==7.1.2
  DAWG-Python==0.7.2
  docopt==0.6.2
  Flask==1.1.2
  Flask-CKEditor==0.4.6
  Flask-Classy==0.6.10
  Flask-Login==0.5.0
  Flask-Migrate==2.7.0
  Flask-Script==2.0.6
  Flask-SQLAlchemy==2.5.1
  Flask-WTF==0.14.3
  fuzzywuzzy==0.18.0
  greenlet==1.0.0
  gunicorn==20.1.0
  idna==2.10
  itsdangerous==1.1.0
  Jinja2==2.11.3
  Mako==1.1.4
  MarkupSafe==1.1.1
  pyenchant==3.2.0
  pymorphy2==0.9.1
  pymorphy2-dicts-ru==2.4.417127.4579844
  python-dateutil==2.8.1
  python-editor==1.0.4
  requests==2.25.1
  six==1.15.0
  SQLAlchemy==1.4.4
  urllib3==1.26.4
  vk-api==11.9.3
  Werkzeug==1.0.1
  WTForms==2.3.3
  ```



## Порядок установки: 

### Для продакта (описано на Ubuntu):

1. Обновить пакеты

   ```bash
   sudo apt update
   sudo apt install python3-pip python3-dev build-essential libssl-dev libffi-dev python3-setuptools
   ```

2. Создание виртуальной среды Python (нужен python3-venv)

   ```bash
   sudo apt install python3-venv
   mkdir ~/faq
   cd ~/faq
   python3 -m venv venv
   ```

3. Активировать виртуальную среду

   ```bash
   source faq/bin/activate
   ```

4. Установить  `wheel`

   ```bash
   pip install wheel
   ```

5.  Установить Flask и Gunicorn

   ```bash
   pip install gunicorn flask
   ```

6. Скачать из репозитория проект и переместить файлы из директории src в только что созданную папку faq на сервере

7. Установить все зависимости

   ```python
   pip install -r requirements.txt
   ```

8. Перенести файлы из папки move_files в папку модуля enchant по пути

   ```
C:\...\Lib\site-packages\enchant\data\mingw64\share\enchant\hunspell\
   ```
   
9. Заменить последние 2 строки app.py на:

   ```python
   if __name__ == "__main__":
       app.run(host='0.0.0.0')
   ```

10. Разрешить доступ к порту 5000

    ```bash
    sudo ufw allow 5000
    ```

11. Проверим работу

    ```bash
    python app.py
    ```

12. Получим примерно такой вывод

    ```
    Output* Serving Flask app "app" (lazy loading)
     * Environment: production
       WARNING: Do not use the development server in a production environment.
       Use a production WSGI server instead.
     * Debug mode: off
     * Running on http://0.0.0.0:5000/ (Press CTRL+C to quit)
    ```

13. Проверим работу сайта перейде по адресу

    ```
    http://your_server_ip:5000
    ```



## Структура приложения:

Само приложение находится в директории src/ - она считается корнем

- /app.py - основной файл, необходимый для запуска
- /config.py - конфигурация проекта
- /models.py - файл описывающий базу данных
- /Procfile - описывает, как необходимо запускать приложение с помощью gunicorn
- /requirements.txt - список необходимых для работы модулей и версий к каждой
- /search.py - функции для работы с поиском по базе вопросов
- /dbase.db - база данных SQLite
- /website/website.py - Блюпринт отвечающий за работу сайта
- /website/templates/website/ - HTML-шаблоны для сайта
- /website/static/ - статичные файлы для сайта
- /static/libraries/ - используемые библиотеки
- /bot/bot.py - Блюпринт отвечающий за работу бота ВКонтакте
- /admin/admin.py - Блюпринт отвечающий за работу админки
- /admin/forms.py - файл содержащий формы из админки
- /admin/templates/admin/ - HTML-шаблоны для админки
- /admin/static/ - статичные файлы для админки
- /admin/views/ - файлы для формирования страниц админки
- /admin/form_handlers/ - обработчики форм для админки
- /admin/functions.py - функции импортируемые для работы админки
- /move_files/ - файлы, которые необходимо перенести внутрь библиотеки pyenchant

